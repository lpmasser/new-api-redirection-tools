# New-API é‡å®šå‘é…ç½®å·¥å…· - å®ç°æ–¹æ¡ˆ

## é¡¹ç›®æ¦‚è¿°

æœ¬å·¥å…·ç”¨äºç®€åŒ– New-API æ¸ é“æ¨¡å‹çš„é‡å®šå‘é…ç½®ï¼Œå°†ä¸åŒæ¸ é“ä¸­å‘½åä¸åŒä½†æœ¬è´¨ç›¸åŒçš„æ¨¡å‹ç»Ÿä¸€æ˜ å°„ä¸ºæ ‡å‡†å‘½åæ ¼å¼ã€‚

---

## ä¸€ã€æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Vue 3 + Vite                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Views (é¡µé¢)                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Settings   â”‚  â”‚  RedirectMap    â”‚  â”‚     Sync       â”‚  â”‚
â”‚  â”‚   è®¾ç½®é¡µ    â”‚  â”‚   æ˜ å°„é…ç½®é¡µ     â”‚  â”‚    åŒæ­¥é¡µ      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Stores (çŠ¶æ€ç®¡ç† - Pinia)                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ configStore â”‚  â”‚  channelStore   â”‚  â”‚  mappingStore  â”‚  â”‚
â”‚  â”‚  é…ç½®ä¿¡æ¯   â”‚  â”‚   æ¸ é“ä¿¡æ¯       â”‚  â”‚   æ˜ å°„è§„åˆ™     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  API Layer (æ¥å£å±‚)                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  channel.ts - æ¸ é“ç›¸å…³ API                               â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€é¡µé¢è®¾è®¡

### 2.1 è®¾ç½®é¡µé¢ (Settings View)

**åŠŸèƒ½**ï¼šé…ç½® API è¿æ¥ä¿¡æ¯

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| baseUrl | string | New-API æœåŠ¡åœ°å€ |
| token | string | Bearer Token |
| userId | string/number | ç”¨æˆ· IDï¼ˆNew-Api-User è¯·æ±‚å¤´ï¼‰ |

**å­˜å‚¨**ï¼šé…ç½®ä¿å­˜åˆ° `localStorage`ï¼Œåº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½

---

### 2.2 é‡å®šå‘æ˜ å°„é¡µé¢ (RedirectMap View)

**é¡µé¢å¸ƒå±€**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ˜ å°„è§„åˆ™è¡¨                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚      åŸæ¨¡å‹å           â”‚         ç»Ÿä¸€å‘½å               â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚  gpt-4-turbo-preview   â”‚  gpt-4-turbo                   â”‚â”‚
â”‚  â”‚  gpt-4-0125-preview    â”‚  gpt-4-turbo                   â”‚â”‚
â”‚  â”‚  claude-3-opus-latest  â”‚  claude-3-opus                 â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ¸ é“åˆ—è¡¨ (å¯æŠ˜å å¡ç‰‡)                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ â–¼ æ¸ é“åç§°: OpenAI-1    çŠ¶æ€: âœ… æ­£å¸¸  â”‚                  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                  â”‚
â”‚  â”‚   â”‚ â˜‘ gpt-4-turbo-preview           â”‚ â”‚                  â”‚
â”‚  â”‚   â”‚ â˜‘ gpt-4-0125-preview            â”‚ â”‚                  â”‚
â”‚  â”‚   â”‚ â˜ gpt-3.5-turbo                 â”‚ â”‚                  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ â–¶ æ¸ é“åç§°: Claude-API  çŠ¶æ€: âœ… æ­£å¸¸  â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº¤äº’é€»è¾‘**ï¼š
1. ç‚¹å‡»æ¸ é“å¡ç‰‡å±•å¼€ï¼Œæ˜¾ç¤ºè¯¥æ¸ é“å¯ç”¨çš„æ¨¡å‹åˆ—è¡¨
2. å‹¾é€‰æ¨¡å‹åï¼Œè‡ªåŠ¨åœ¨ä¸Šæ–¹æ˜ å°„è§„åˆ™è¡¨ä¸­æ·»åŠ æ¡ç›®
3. ç”¨æˆ·å¯ä»¥ç¼–è¾‘ç»Ÿä¸€å‘½ååˆ—

---

### 2.3 åŒæ­¥é¡µé¢ (Sync View)

**åŠŸèƒ½**ï¼šå°†é…ç½®å¥½çš„æ˜ å°„è§„åˆ™åŒæ­¥åˆ° New-API

**é¡µé¢å…ƒç´ **ï¼š
- åŒæ­¥æ¨¡å¼é€‰æ‹©ï¼ˆæ»‘å—/å¼€å…³ï¼‰
  - **è¿½åŠ æ¨¡å¼**ï¼šä¿ç•™æ¸ é“åŸæœ‰ model_mappingï¼Œè¿½åŠ æ–°è§„åˆ™
  - **è¦†ç›–æ¨¡å¼**ï¼šå®Œå…¨æ›¿æ¢æ¸ é“çš„ model_mapping
- åŒæ­¥æŒ‰é’®
- åŒæ­¥çŠ¶æ€/æ—¥å¿—æ˜¾ç¤ºåŒºåŸŸ

---

## ä¸‰ã€å…¨å±€çŠ¶æ€è®¾è®¡ (Pinia Stores)

### 3.1 configStore - é…ç½®ä¿¡æ¯

```typescript
interface ConfigState {
  baseUrl: string;     // API åŸºç¡€åœ°å€
  token: string;       // Bearer Token
  userId: string;      // ç”¨æˆ· ID
}
```

**æŒä¹…åŒ–**ï¼šä¿å­˜åˆ° localStorage

---

### 3.2 channelStore - æ¸ é“ä¿¡æ¯

```typescript
interface Channel {
  id: number;
  name: string;
  status: number;              // 1=å¯ç”¨
  models: string;              // å½“å‰å¯ç”¨çš„æ¨¡å‹ï¼ˆé€—å·åˆ†éš”ï¼‰
  model_mapping: string;       // å½“å‰çš„æ˜ å°„é…ç½®ï¼ˆJSON å­—ç¬¦ä¸²ï¼‰
  upstreamModels?: string[];   // ä¸Šæ¸¸æ¨¡å‹åˆ—è¡¨ï¼ˆé€šè¿‡ fetch_models è·å–ï¼‰
}

interface ChannelState {
  channels: Channel[];
  loading: boolean;
  error: string | null;
}
```

**Actions**:
- `fetchChannels()` - è·å–æ‰€æœ‰æ¸ é“
- `fetchUpstreamModels(channelId)` - è·å–æŒ‡å®šæ¸ é“çš„ä¸Šæ¸¸æ¨¡å‹åˆ—è¡¨
- `updateChannelMapping(channelId, mapping)` - æ›´æ–°æ¸ é“çš„ model_mapping

---

### 3.3 mappingStore - æ˜ å°„è§„åˆ™

```typescript
interface MappingRule {
  sourceModel: string;    // åŸæ¨¡å‹å
  targetModel: string;    // ç»Ÿä¸€å‘½å
  channelIds: number[];   // å…³è”çš„æ¸ é“ ID
}

interface MappingState {
  rules: MappingRule[];
  syncMode: 'append' | 'overwrite';  // åŒæ­¥æ¨¡å¼
}
```

**æŒä¹…åŒ–**ï¼šä¿å­˜åˆ° localStorage

---

## å››ã€API æ¥å£å°è£…

åŸºäºç°æœ‰ API æ–‡æ¡£ï¼Œéœ€è¦å°è£…ä»¥ä¸‹æ¥å£ï¼š

### 4.1 è·å–æ‰€æœ‰æ¸ é“
```typescript
// GET /api/channel/
// Headers: Authorization: Bearer {token}, New-Api-User: {userId}
function getChannels(): Promise<ChannelListResponse>
```

### 4.2 è·å–ä¸Šæ¸¸æ¨¡å‹åˆ—è¡¨
```typescript
// GET /api/channel/fetch_models/{id}
function fetchUpstreamModels(channelId: number): Promise<string[]>
```

### 4.3 æ›´æ–°æ¸ é“
```typescript
// PUT /api/channel/
// Body: { id: number, model_mapping: string }
function updateChannel(channelId: number, modelMapping: string): Promise<void>
```

---

## äº”ã€æ•°æ®æµè®¾è®¡

### 5.1 æ˜ å°„è§„åˆ™ç”Ÿæˆæµç¨‹

```mermaid
flowchart LR
    A[ç”¨æˆ·åœ¨æ¸ é“å¡ç‰‡å‹¾é€‰æ¨¡å‹] --> B[æ·»åŠ æ˜ å°„è§„åˆ™åˆ°è¡¨æ ¼]
    B --> C[ç”¨æˆ·ç¼–è¾‘ç»Ÿä¸€å‘½å]
    C --> D[mappingStore æ›´æ–°è§„åˆ™]
    D --> E[è‡ªåŠ¨ä¿å­˜åˆ° localStorage]
```

### 5.2 åŒæ­¥æµç¨‹

**æ ¸å¿ƒé€»è¾‘**ï¼šPUT è¯·æ±‚éœ€è¦æ›´æ–°ä¸¤ä¸ªå­—æ®µ

| å­—æ®µ | è¯´æ˜ |
|------|------|
| `models` | é‡å®šå‘åçš„ç»Ÿä¸€å‘½ååˆ—è¡¨ï¼ˆé€—å·åˆ†éš”ï¼‰ |
| `model_mapping` | åŸæ¨¡å‹å â†’ ç»Ÿä¸€å‘½åçš„æ˜ å°„è§„åˆ™ï¼ˆJSON å­—ç¬¦ä¸²ï¼‰ |

**åŒæ­¥ç®—æ³•**ï¼š

1. éå†æ¯ä¸ªæ¸ é“ï¼Œè·å–å…¶ä¸Šæ¸¸æ¨¡å‹åˆ—è¡¨ `upstreamModels`
2. å°† `upstreamModels` ä¸å…¨å±€æ˜ å°„è§„åˆ™ `rules` åŒ¹é…
3. æ‰¾å‡ºè¯¥æ¸ é“æ‹¥æœ‰çš„æ¨¡å‹ï¼Œç”Ÿæˆï¼š
   - `models`: åŒ¹é…åˆ°çš„æ¨¡å‹é‡å®šå‘åçš„ç»Ÿä¸€å‘½åï¼ˆå»é‡ï¼‰
   - `model_mapping`: `{ "åŸæ¨¡å‹å": "ç»Ÿä¸€å‘½å", ... }`
4. æ ¹æ®åŒæ­¥æ¨¡å¼å¤„ç†ï¼š
   - **è¦†ç›–æ¨¡å¼**ï¼šç›´æ¥ä½¿ç”¨æ–°ç”Ÿæˆçš„ `models` å’Œ `model_mapping`
   - **è¿½åŠ æ¨¡å¼**ï¼šå°†æ–° `models` ä¸åŸ `models` å–å¹¶é›†ï¼Œ`model_mapping` åˆå¹¶ï¼ˆæ–°è§„åˆ™ä¼˜å…ˆï¼‰

```mermaid
flowchart TD
    A[ç‚¹å‡»åŒæ­¥æŒ‰é’®] --> B[éå†æ¯ä¸ªæ¸ é“]
    B --> C[è·å–æ¸ é“ä¸Šæ¸¸æ¨¡å‹åˆ—è¡¨]
    C --> D[åŒ¹é…å…¨å±€æ˜ å°„è§„åˆ™]
    D --> E[ç”Ÿæˆ models å’Œ model_mapping]
    E --> F{åŒæ­¥æ¨¡å¼?}
    F -->|è¦†ç›–æ¨¡å¼| G[ç›´æ¥ä½¿ç”¨æ–°é…ç½®]
    F -->|è¿½åŠ æ¨¡å¼| H[ä¸åŸé…ç½®å–å¹¶é›†]
    G --> I[PUT /api/channel/]
    H --> I
    I --> J[æ˜¾ç¤ºåŒæ­¥ç»“æœ]
```

**ç¤ºä¾‹**ï¼š

å‡è®¾æ¸ é“ä¸Šæ¸¸æ¨¡å‹ä¸º `["gpt-4-turbo-preview", "gpt-4-0125", "gpt-3.5-turbo"]`

å…¨å±€æ˜ å°„è§„åˆ™ä¸ºï¼š
- `gpt-4-turbo-preview` â†’ `gpt-4-turbo`
- `gpt-4-0125` â†’ `gpt-4-turbo`

åŒ¹é…åç”Ÿæˆï¼š
```json
{
  "id": 1,
  "models": "gpt-4-turbo,gpt-3.5-turbo",
  "model_mapping": "{\"gpt-4-turbo-preview\":\"gpt-4-turbo\",\"gpt-4-0125\":\"gpt-4-turbo\"}"
}
```

---

## å…­ã€ç›®å½•ç»“æ„è§„åˆ’

```
src/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ channel.ts          # æ¸ é“ç›¸å…³ API
â”‚   â””â”€â”€ types.ts             # API ç±»å‹å®šä¹‰
â”œâ”€â”€ stores/
â”‚   â”œâ”€â”€ config.ts            # é…ç½® store
â”‚   â”œâ”€â”€ channel.ts           # æ¸ é“ store
â”‚   â””â”€â”€ mapping.ts           # æ˜ å°„è§„åˆ™ store
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ SettingsView.vue     # è®¾ç½®é¡µé¢
â”‚   â”œâ”€â”€ RedirectMapView.vue  # é‡å®šå‘æ˜ å°„é¡µé¢
â”‚   â””â”€â”€ SyncView.vue         # åŒæ­¥é¡µé¢
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ChannelCard.vue      # æ¸ é“å¡ç‰‡ç»„ä»¶
â”‚   â”œâ”€â”€ MappingTable.vue     # æ˜ å°„è§„åˆ™è¡¨æ ¼ç»„ä»¶
â”‚   â””â”€â”€ NavBar.vue           # å¯¼èˆªæ ç»„ä»¶
â”œâ”€â”€ router/
â”‚   â””â”€â”€ index.ts             # Vue Router é…ç½®
â””â”€â”€ App.vue
```

---

## ä¸ƒã€éœ€è¦å®‰è£…çš„ä¾èµ–

```bash
pnpm add vue-router@4 pinia pinia-plugin-persistedstate
```

| ä¾èµ– | ç”¨é€” |
|------|------|
| vue-router | é¡µé¢è·¯ç”± |
| pinia | çŠ¶æ€ç®¡ç† |
| pinia-plugin-persistedstate | çŠ¶æ€æŒä¹…åŒ–åˆ° localStorage |

---

## å…«ã€æ–¹æ¡ˆè¯„ä¼°

### âœ… ä¼˜ç‚¹

1. **ç»“æ„æ¸…æ™°**ï¼šä¸‰é¡µé¢åˆ†å·¥æ˜ç¡®ï¼Œè®¾ç½®/é…ç½®/æ‰§è¡Œå„å¸å…¶èŒ
2. **çŠ¶æ€ç®¡ç†åˆç†**ï¼šä½¿ç”¨ Pinia ç®¡ç†å…¨å±€çŠ¶æ€ï¼Œæ”¯æŒæŒä¹…åŒ–
3. **å®¹é”™è®¾è®¡**ï¼šä¸Šæ¸¸æ¨¡å‹æ‹‰å–å¤±è´¥æ—¶å¯å›é€€åˆ°å½“å‰å¯ç”¨æ¨¡å‹
4. **çµæ´»çš„åŒæ­¥æ¨¡å¼**ï¼šè¿½åŠ /è¦†ç›–ä¸¤ç§æ¨¡å¼æ»¡è¶³ä¸åŒéœ€æ±‚

### âš ï¸ éœ€è¦æ³¨æ„

1. **åˆ†é¡µå¤„ç†**ï¼šè·å–æ¸ é“æ¥å£æœ‰åˆ†é¡µï¼Œéœ€è¦å¤„ç†å¤šé¡µæ•°æ®
2. **é”™è¯¯å¤„ç†**ï¼šéœ€è¦å®Œå–„ API è°ƒç”¨çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º
3. **æ˜ å°„å†²çª**ï¼šåŒä¸€æ¨¡å‹è¢«æ˜ å°„åˆ°å¤šä¸ªç›®æ ‡æ—¶éœ€è¦æç¤ºç”¨æˆ·

### ğŸ’¡ å»ºè®®è¡¥å……

1. æ·»åŠ ã€Œä¸€é”®åˆ·æ–°æ‰€æœ‰æ¸ é“ä¸Šæ¸¸æ¨¡å‹ã€çš„åŠŸèƒ½
2. æ·»åŠ ã€Œé¢„è§ˆåŒæ­¥ç»“æœã€åŠŸèƒ½ï¼Œåœ¨å®é™…åŒæ­¥å‰å±•ç¤ºå°†è¦å†™å…¥çš„é…ç½®
3. è€ƒè™‘æ·»åŠ æ˜ å°„è§„åˆ™çš„å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½

---

## ä¹ã€å®ç°è®¡åˆ’

| é˜¶æ®µ | å†…å®¹ | é¢„è®¡å·¥ä½œé‡ |
|------|------|------------|
| 1 | å®‰è£…ä¾èµ–ã€é…ç½®è·¯ç”±å’Œ Pinia | å° |
| 2 | å®ç° API å±‚å’Œ Stores | ä¸­ |
| 3 | å®ç°è®¾ç½®é¡µé¢ | å° |
| 4 | å®ç°é‡å®šå‘æ˜ å°„é¡µé¢ | å¤§ |
| 5 | å®ç°åŒæ­¥é¡µé¢ | ä¸­ |
| 6 | æ ·å¼ä¼˜åŒ–å’Œæµ‹è¯• | ä¸­ |

---

## åã€éªŒè¯è®¡åˆ’

### æ‰‹åŠ¨æµ‹è¯•æ­¥éª¤

1. **è®¾ç½®é¡µé¢æµ‹è¯•**
   - è¾“å…¥ baseUrlã€tokenã€userIdï¼Œåˆ·æ–°é¡µé¢ç¡®è®¤æ•°æ®ä¿ç•™
   
2. **æ˜ å°„é…ç½®æµ‹è¯•**
   - ç‚¹å‡»æ¸ é“å¡ç‰‡å±•å¼€
   - å‹¾é€‰æ¨¡å‹ï¼Œç¡®è®¤æ˜ å°„è¡¨æ›´æ–°
   - ç¼–è¾‘ç»Ÿä¸€å‘½åï¼Œç¡®è®¤ä¿å­˜æ­£å¸¸

3. **åŒæ­¥æµ‹è¯•**
   - é€‰æ‹©è¿½åŠ /è¦†ç›–æ¨¡å¼
   - ç‚¹å‡»åŒæ­¥æŒ‰é’®
   - åœ¨ New-API åå°éªŒè¯ model_mapping æ˜¯å¦æ­£ç¡®æ›´æ–°
